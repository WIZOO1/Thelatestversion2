<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- SEO & BRANDING -->
    <title>Vitrina TakTak - Votre Boutique en 1 Clic</title>
    <meta name="description" content="Cr√©ez votre boutique en ligne en Tunisie pour 30 DT/mois. Commandes sur WhatsApp.">
    
    <!-- SOCIAL TAGS -->
    <meta property="og:title" content="Vitrina TakTak üáπüá≥">
    <meta property="og:description" content="Hanoutek fi lien. Commandetk f WhatsApp.">
    <meta property="og:image" content="https://placehold.co/1200x630/0f0f0f/D4AF37?text=Vitrina+TakTak">
    <meta property="og:url" content="https://vitrinataktak.store">
    
    <!-- LIBRARIES -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    
    <!-- STYLES -->
    <style>
        :root { --primary-black: #050505; --gold: #D4AF37; }
        body { font-family: 'Tajawal', sans-serif; background-color: var(--primary-black); color: white; overflow-x: hidden; -webkit-tap-highlight-color: transparent; }
        
        /* PREMIUM GLOW BACKGROUND */
        .glow-bg {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -1;
            background: 
                radial-gradient(circle at 15% 20%, rgba(212, 175, 55, 0.08), transparent 25%),
                radial-gradient(circle at 85% 60%, rgba(76, 29, 149, 0.05), transparent 30%);
        }

        /* GLASS CARDS */
        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.5);
        }

        /* GOLD TEXT GRADIENT */
        .text-gradient {
            background: linear-gradient(135deg, #FFF 0%, #D4AF37 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* APP UTILS */
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .fade-in { animation: fadeIn 0.5s ease-out forwards; opacity: 0; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        [dir="rtl"] .rtl-flip { transform: scaleX(-1); }
        
        /* ADMIN STYLES */
        .admin-badge {
            position: fixed; bottom: 20px; right: 20px; z-index: 9999;
            background: #ff0000; color: white; width: 20px; height: 20px;
            border-radius: 50%; font-size: 12px; display: flex;
            align-items: center; justify-content: center;
            cursor: pointer; box-shadow: 0 0 10px rgba(255,0,0,0.5);
        }
        
        /* TEMPLATE CARD */
        .template-card {
            border-left: 4px solid #D4AF37;
        }
    </style>
</head>
<body class="antialiased selection:bg-[#D4AF37] selection:text-black">

    <div class="glow-bg"></div>

    <!-- ADMIN BADGE (Only shows when ?admin=taktak) -->
    <div id="admin-badge" class="admin-badge hidden" onclick="toggleAdminPanel()">A</div>

    <!-- =========================================
         PART 1: LANDING PAGE (SALES)
         Visible if NO ?store=...
    ========================================== -->
    <div id="landing-page" class="hidden min-h-screen flex-col relative pb-20">
        
        <!-- Navbar -->
        <nav class="flex justify-between items-center p-6 w-full max-w-lg mx-auto">
            <div class="font-bold text-xl tracking-tight flex items-center gap-2">
                <span class="text-2xl">‚ö°</span> Vitrina<span class="text-[#D4AF37]">.</span>
            </div>
            <div class="text-[10px] font-bold bg-[#D4AF37]/10 text-[#D4AF37] px-3 py-1 rounded-full border border-[#D4AF37]/20">
                BETA üáπüá≥
            </div>
        </nav>

        <!-- Hero Section -->
        <header class="flex flex-col justify-center items-center text-center px-6 mt-4 w-full max-w-lg mx-auto">
            
            <h1 class="text-5xl md:text-7xl font-black mb-6 leading-[0.95] tracking-tight fade-in">
                Hanoutek <br>
                fi <span class="text-gradient">Lien.</span>
            </h1>
            
            <p class="text-gray-400 text-lg mb-10 max-w-xs leading-relaxed fade-in" style="animation-delay: 0.1s">
                Arr√™tez de r√©pondre "Prix ?"<br> 
                <span class="text-white font-medium">Automatisez vos commandes WhatsApp.</span>
            </p>

            <!-- OFFER CARD (30DT) -->
            <div class="glass-card p-6 rounded-3xl w-full mb-12 relative overflow-hidden group fade-in" style="animation-delay: 0.2s">
                <div class="absolute top-0 right-0 bg-[#D4AF37] text-black text-[10px] font-bold px-3 py-1 rounded-bl-xl">POPULAIRE</div>
                
                <div class="flex justify-between items-end mb-6">
                    <div class="text-left">
                        <div class="text-gray-400 text-[10px] font-bold uppercase tracking-widest mb-1">ABONNEMENT</div>
                        <div class="text-5xl font-black text-white">30<span class="text-2xl text-[#D4AF37]">DT</span></div>
                    </div>
                    <div class="text-right text-xs text-gray-500 mb-2">/ mois</div>
                </div>

                <a href="https://wa.me/21622747298?text=Salam%20nheb%20nhal%20Vitrina%20(Offre%2030DT)" 
                   class="block w-full bg-[#D4AF37] hover:bg-[#c4a02e] text-black font-bold py-4 rounded-xl transition-all active:scale-[0.98] shadow-lg shadow-[#D4AF37]/20">
                    Lancer ma Boutique
                </a>
                <p class="text-[10px] text-gray-500 mt-3">Paiement via D17 / Flouci / Sobflous</p>
            </div>

            <!-- SECTION: KIFEH TEMCHI -->
            <div class="w-full text-left mb-12 fade-in" style="animation-delay: 0.3s">
                <h2 class="text-2xl font-bold mb-6 text-center">Kifeh temchi?</h2>
                
                <div class="space-y-4">
                    <!-- Step 1 -->
                    <div class="glass-card p-4 rounded-2xl flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center text-2xl border border-white/10">üì∏</div>
                        <div>
                            <h3 class="font-bold text-white">1. Eb3ath Taswira</h3>
                            <p class="text-xs text-gray-400">Envoyez vos photos et prix sur WhatsApp.</p>
                        </div>
                    </div>

                    <!-- Step 2 -->
                    <div class="glass-card p-4 rounded-2xl flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center text-2xl border border-white/10">‚ö°</div>
                        <div>
                            <h3 class="font-bold text-white">2. Hata chay ma yestanna</h3>
                            <p class="text-xs text-gray-400">On cr√©e votre lien <b>vitrinataktak.store</b> en 1h.</p>
                        </div>
                    </div>

                    <!-- Step 3 -->
                    <div class="glass-card p-4 rounded-2xl flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center text-2xl border border-white/10">üí∏</div>
                        <div>
                            <h3 class="font-bold text-white">3. Dakhel Flous</h3>
                            <p class="text-xs text-gray-400">Partagez le lien. Recevez les commandes propres.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Demo Link -->
            <button onclick="window.location.href='?store=demo'" class="bg-white/5 hover:bg-white/10 border border-white/10 text-white px-6 py-3 rounded-full text-sm font-medium transition-colors fade-in" style="animation-delay: 0.4s">
                Voir un exemple gratuit
            </button>

        </header>

        <footer class="mt-auto text-center py-6 text-[10px] text-gray-600">
            &copy; 2026 Vitrina TakTak.
        </footer>
    </div>

    <!-- =========================================
         PART 2: STORE APP (PRODUCT)
         Visible if ?store=XYZ exists
    ========================================== -->
    <div id="store-app" class="hidden bg-gray-50 text-gray-900 min-h-screen relative z-10">
        
        <!-- Store Loader -->
        <div id="loader" class="fixed inset-0 bg-white z-[60] flex flex-col items-center justify-center">
            <div class="w-10 h-10 border-4 border-gray-100 border-t-[#D4AF37] rounded-full animate-spin mb-3"></div>
            <p class="text-xs text-gray-400 font-bold tracking-widest uppercase">Vitrina</p>
        </div>

        <!-- Store Nav -->
        <nav class="fixed top-0 left-0 w-full bg-white/95 backdrop-blur-md border-b border-gray-100 z-50 h-16 shadow-sm">
            <div class="max-w-md mx-auto px-4 h-full flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-black flex items-center justify-center text-[#D4AF37] font-bold border-2 border-[#D4AF37] overflow-hidden shadow-md">
                        <img id="store-logo" src="" class="w-full h-full object-cover hidden">
                        <span id="store-initial">V</span>
                    </div>
                    <div>
                        <h1 id="store-name" class="font-bold text-gray-900 text-lg leading-tight">...</h1>
                        <div class="flex items-center gap-1">
                            <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                            <span class="text-[10px] font-bold text-gray-500 uppercase tracking-wide">ONLINE</span>
                        </div>
                    </div>
                </div>
                <button onclick="cycleLanguage()" class="bg-gray-50 border border-gray-200 px-3 py-1.5 rounded-full text-xs font-bold flex items-center gap-1">
                    <span id="lang-icon">üáπüá≥</span> <span id="lang-text">TN</span>
                </button>
            </div>
        </nav>

        <!-- Store Content -->
        <main class="max-w-md mx-auto pt-20 px-4 pb-32">
            <div class="sticky top-16 bg-gray-50 pt-2 pb-4 z-40 -mx-4 px-4 mb-2">
                <input type="text" id="search-input" oninput="handleSearch()" class="w-full bg-white border border-gray-200 rounded-xl py-3.5 pl-10 text-sm focus:outline-none focus:ring-1 focus:ring-[#D4AF37] shadow-sm" placeholder="...">
                <div id="category-list" class="flex gap-2 overflow-x-auto hide-scrollbar mt-3 pb-1"></div>
            </div>
            <div id="product-grid" class="grid grid-cols-2 gap-3"></div>
            <div id="empty-state" class="hidden flex-col items-center justify-center py-20 opacity-50 text-sm font-medium">Aucun produit trouv√©</div>
        </main>

        <!-- Cart Bar -->
        <div id="cart-bar" class="fixed bottom-0 left-0 w-full bg-white border-t border-gray-100 p-4 z-50 transform translate-y-full transition-transform duration-300 shadow-[0_-5px_20px_rgba(0,0,0,0.1)]">
            <div class="max-w-md mx-auto flex items-center justify-between gap-4">
                <div class="flex flex-col cursor-pointer" onclick="toggleModal(true)">
                    <span class="text-[10px] text-gray-500 font-bold uppercase tracking-wider" data-translate="total">TOTAL</span>
                    <span id="bar-total" class="text-xl font-black text-gray-900">0.000</span>
                </div>
                <button onclick="toggleModal(true)" class="flex-1 bg-black text-[#D4AF37] font-bold py-3.5 rounded-xl flex items-center justify-center gap-2 shadow-lg active:scale-95 transition-transform">
                    <span data-translate="viewCart">Voir Panier</span>
                    <span id="cart-badge" class="bg-[#D4AF37] text-black text-[10px] font-bold px-1.5 py-0.5 rounded-md">0</span>
                </button>
            </div>
        </div>

        <!-- Cart Modal -->
        <div id="cart-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-[60] hidden flex items-end justify-center" onclick="toggleModal(false)">
            <div class="bg-white w-full max-w-md rounded-t-2xl p-6 max-h-[85vh] flex flex-col shadow-2xl" onclick="event.stopPropagation()">
                <div class="w-12 h-1.5 bg-gray-200 rounded-full mx-auto mb-6"></div>
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-gray-900" data-translate="yourCart">Votre Panier</h2>
                    <button onclick="toggleModal(false)" class="p-2 bg-gray-100 rounded-full"><svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>
                </div>
                <div id="cart-list" class="overflow-y-auto flex-1 space-y-4 mb-6 pr-1"></div>
                <button onclick="sendToWhatsApp()" class="w-full bg-[#25D366] text-white font-bold py-4 rounded-xl flex items-center justify-center gap-2 shadow-lg active:scale-[0.98] transition-transform">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981z"/></svg>
                    <span data-translate="confirmOrder">Commander sur WhatsApp</span>
                </button>
            </div>
        </div>
    </div>

    <!-- =========================================
         PART 3: ENHANCED ADMIN PANEL
         Visible only when ?admin=taktak
    ========================================== -->
    <div id="admin-panel" class="hidden fixed inset-0 bg-white z-[100] p-4 overflow-y-auto">
        <div class="max-w-md mx-auto">
            <!-- Header -->
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h1 class="text-2xl font-bold text-black">‚ö° Vitrina Admin</h1>
                    <p class="text-sm text-gray-600">Gestion manuelle - Android Friendly</p>
                </div>
                <button onclick="toggleAdminPanel()" class="p-2 bg-gray-100 rounded-lg">‚úï</button>
            </div>

            <!-- Quick Stats -->
            <div class="grid grid-cols-2 gap-3 mb-6">
                <div class="bg-gray-50 p-4 rounded-xl border">
                    <p class="text-xs text-gray-500">Clients actifs</p>
                    <p id="client-count" class="text-2xl font-bold">0</p>
                </div>
                <div class="bg-gray-50 p-4 rounded-xl border">
                    <p class="text-xs text-gray-500">Produits totaux</p>
                    <p id="product-count" class="text-2xl font-bold">0</p>
                </div>
            </div>

            <!-- SECTION 1: WHATSAPP TEMPLATES -->
            <div class="template-card bg-blue-50 border border-blue-200 p-4 rounded-2xl mb-6">
                <h3 class="font-bold text-lg mb-3 text-blue-800">üì± Templates WhatsApp</h3>
                
                <div class="space-y-3">
                    <!-- Template 1: Demande de produits -->
                    <div class="bg-white p-3 rounded-lg border border-blue-100">
                        <p class="text-sm font-bold text-gray-800 mb-2">1. Demande de produits (copiez ce message):</p>
                        <textarea id="template-request" rows="4" class="w-full text-sm border rounded p-2 font-mono" readonly>Salam! Pour cr√©er votre boutique, envoyez-moi:

1Ô∏è‚É£ Nom de votre boutique:
2Ô∏è‚É£ Votre num√©ro WhatsApp:
3Ô∏è‚É£ Vos produits avec prix (exemple):

Robe rouge | 89.000 | V√™tements
Sac cuir | 120.000 | Accessoires
Chaussures | 75.000 | Chaussures

Envoyez les photos s√©par√©ment.</textarea>
                        <button onclick="copyTemplate('template-request')" class="mt-2 w-full bg-blue-500 hover:bg-blue-600 text-white text-sm font-bold py-2 rounded-lg">
                            üìã Copier ce message
                        </button>
                    </div>

                    <!-- Template 2: Message de bienvenue -->
                    <div class="bg-white p-3 rounded-lg border border-blue-100">
                        <p class="text-sm font-bold text-gray-800 mb-2">2. Message de bienvenue automatique:</p>
                        <textarea id="welcome-template" rows="4" class="w-full text-sm border rounded p-2 font-mono" readonly>üéâ F√©licitations! Votre boutique est pr√™te:

üîó Lien de votre boutique:
[LIEN_BOUTIQUE]

üì¶ Comment √ßa marche:
1. Partagez le lien avec vos clients
2. Ils choisissent les produits
3. Ils passent commande via WhatsApp
4. Vous recevez la commande compl√®te

üí∞ Abonnement: 30 DT/mois
üí≥ Paiement: D17 / Flouci / Sobflous

Testez votre boutique et envoyez-moi votre retour!</textarea>
                        <button onclick="copyTemplate('welcome-template')" class="mt-2 w-full bg-green-500 hover:bg-green-600 text-white text-sm font-bold py-2 rounded-lg">
                            üìã Copier message bienvenue
                        </button>
                    </div>
                </div>
            </div>

            <!-- SECTION 2: ADD NEW CLIENT -->
            <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-2xl mb-6">
                <h3 class="font-bold text-lg mb-3 text-yellow-800">‚ûï Ajouter un nouveau client</h3>
                
                <div class="space-y-3">
                    <div class="grid grid-cols-2 gap-3">
                        <input type="text" id="client-id" placeholder="ID (ex: hanoutAli)" class="p-3 border border-yellow-300 rounded-lg bg-white">
                        <input type="text" id="client-name" placeholder="Nom du magasin" class="p-3 border border-yellow-300 rounded-lg bg-white">
                    </div>
                    
                    <input type="text" id="client-phone" placeholder="WhatsApp (21655123456)" class="w-full p-3 border border-yellow-300 rounded-lg bg-white">
                    <input type="text" id="client-logo" placeholder="Logo URL (optionnel)" class="w-full p-3 border border-yellow-300 rounded-lg bg-white">
                    
                    <!-- Quick Import -->
                    <div class="bg-white p-3 rounded-lg border border-yellow-300">
                        <div class="flex justify-between items-center mb-2">
                            <p class="text-xs font-bold text-gray-600">Import rapide depuis WhatsApp:</p>
                            <button onclick="showImportHelp()" class="text-xs text-blue-500">?</button>
                        </div>
                        <textarea id="client-products" rows="4" class="w-full text-sm font-mono" placeholder="Copiez-collez ici les produits du client (format automatique d√©tect√©)

Exemples accept√©s:
1. Robe rouge - 89 DT
2. Robe rouge | 89.000
3. Robe rouge | 89.000 | V√™tements
4. Robe rouge 89.000 V√™tements"></textarea>
                        
                        <div class="flex gap-2 mt-2">
                            <button onclick="formatProducts()" class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 text-xs font-bold py-2 rounded">
                                üîß Formater automatiquement
                            </button>
                            <button onclick="testProducts()" class="flex-1 bg-purple-100 hover:bg-purple-200 text-purple-800 text-xs font-bold py-2 rounded">
                                üëÅÔ∏è Pr√©visualiser
                            </button>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="addNewClient()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 rounded-lg">
                            ‚úÖ Cr√©er store
                        </button>
                        <button onclick="generateWelcomeMessage()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg">
                            üí¨ G√©n√©rer message
                        </button>
                    </div>
                </div>
            </div>

            <!-- SECTION 3: MANAGE EXISTING CLIENTS -->
            <div class="mb-8">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-lg">üìã Stores existants</h3>
                    <span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full" id="active-clients">0 actifs</span>
                </div>
                <div id="clients-list" class="space-y-3"></div>
            </div>

            <!-- SECTION 4: EXPORT/IMPORT -->
            <div class="bg-gray-50 border border-gray-200 p-4 rounded-2xl mb-8">
                <h3 class="font-bold text-lg mb-3">üíæ Backup & Restore</h3>
                
                <div class="grid grid-cols-2 gap-3 mb-3">
                    <button onclick="exportStores()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg flex items-center justify-center gap-2">
                        üì• Exporter tout
                    </button>
                    <button onclick="importStores()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 rounded-lg flex items-center justify-center gap-2">
                        üì§ Importer JSON
                    </button>
                </div>
                
                <div class="text-center">
                    <button onclick="clearAllData()" class="text-xs text-red-500 hover:text-red-700">
                        ‚ùå R√©initialiser tout (demo only)
                    </button>
                </div>
            </div>

            <!-- Instructions -->
            <div class="p-4 bg-gray-100 rounded-xl">
                <h4 class="font-bold mb-2">‚ö° Workflow rapide:</h4>
                <ol class="text-sm text-gray-700 list-decimal pl-4 space-y-1">
                    <li>Copiez "Demande de produits" ‚Üí Envoyez au client</li>
                    <li>Client r√©pond avec produits ‚Üí Copiez dans "Import rapide"</li>
                    <li>Cliquez "Formater automatiquement"</li>
                    <li>Cliquez "Cr√©er store"</li>
                    <li>Cliquez "G√©n√©rer message" ‚Üí Envoyez au client</li>
                </ol>
                <p class="text-xs text-gray-500 mt-3">‚è±Ô∏è Temps total: 3-5 minutes par client</p>
            </div>
        </div>
    </div>

    <!-- PRODUCT PREVIEW MODAL -->
    <div id="preview-modal" class="hidden fixed inset-0 bg-black/60 z-[110] flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-md rounded-2xl p-6 max-h-[80vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold">Aper√ßu des produits</h3>
                <button onclick="closePreview()" class="p-2">‚úï</button>
            </div>
            <div id="preview-content" class="space-y-3"></div>
            <button onclick="closePreview()" class="w-full mt-4 bg-gray-100 hover:bg-gray-200 text-gray-800 font-bold py-3 rounded-lg">
                Fermer
            </button>
        </div>
    </div>

    <!-- =========================================
         JAVASCRIPT LOGIC
    ========================================== -->
    <script>
        // ==================== DATA ====================
        const DEMO_STORE = {
            "demo": {
                name: "Vitrina Demo",
                phone: "21622747298",
                logo: "",
                products: [
                    { id: 1, name: "T-Shirt Vitrina", price: 35.000, category: "Hommes", image: "https://placehold.co/400x400/black/gold?text=T-Shirt" },
                    { id: 2, name: "Casquette Pro", price: 25.000, category: "Accessoires", image: "https://placehold.co/400x400/black/white?text=Casquette" },
                    { id: 3, name: "Sac √† dos", price: 89.000, category: "Accessoires", image: "https://placehold.co/400x400/black/gold?text=Sac" }
                ]
            }
        };

        let ALL_STORES = JSON.parse(localStorage.getItem('vitrina_stores')) || DEMO_STORE;

        const DICTIONARY = {
            fr: { add: "Ajouter", total: "TOTAL", viewCart: "Voir Panier", yourCart: "Votre Panier", confirmOrder: "Commander sur WhatsApp", noResult: "Aucun produit trouv√©", currency: "DT", whatsappIntro: "Bonjour, je voudrais commander :" },
            tn: { add: "Zid", total: "EL SOMME", viewCart: "Chouf el Koffa", yourCart: "Kofftek", confirmOrder: "Aadi Commande", noResult: "Ma famma chay", currency: "DT", whatsappIntro: "Salam, nheb ncommandi hedhom :" },
            ar: { add: "ÿ•ÿ∂ÿßŸÅÿ©", total: "ÿßŸÑŸÖÿ¨ŸÖŸàÿπ", viewCart: "ÿπÿ±ÿ∂ ÿßŸÑÿ≥ŸÑÿ©", yourCart: "ÿ≥ŸÑÿ© ÿßŸÑŸÖÿ¥ÿ™ÿ±Ÿäÿßÿ™", confirmOrder: "ÿ£ÿ∑ŸÑÿ® ÿπÿ®ÿ± Ÿàÿßÿ™ÿ≥ÿßÿ®", noResult: "ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÜÿ™ÿßÿ¶ÿ¨", currency: "ÿØ.ÿ™", whatsappIntro: "ŸÖÿ±ÿ≠ÿ®ÿßÿå ÿ£ÿ±ŸäÿØ ÿ∑ŸÑÿ® Ÿáÿ∞Ÿá ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ :" }
        };

        const STATE = { 
            lang: 'tn', 
            storeId: null, 
            cart: {}, 
            activeCategory: 'all', 
            searchQuery: '',
            isAdmin: false,
            currentClientId: null
        };

        // ==================== INITIALIZATION ====================
        function init() {
            const params = new URLSearchParams(window.location.search);
            STATE.storeId = params.get('store');
            
            if (params.get('admin') === 'taktak') {
                STATE.isAdmin = true;
                document.getElementById('admin-badge').classList.remove('hidden');
                showAdminStats();
            }

            if (STATE.storeId && ALL_STORES[STATE.storeId]) {
                document.getElementById('store-app').classList.remove('hidden');
                setupStoreUI(); 
                renderCategories(); 
                renderProducts(true);
                setTimeout(() => document.getElementById('loader').classList.add('hidden'), 500);
            } else {
                document.getElementById('landing-page').classList.remove('hidden');
                document.getElementById('landing-page').classList.add('flex');
            }
        }

        // ==================== STORE FUNCTIONS ====================
        function setupStoreUI() {
            const store = ALL_STORES[STATE.storeId];
            if (!store) return;
            
            document.title = `${store.name} | Vitrina`;
            document.getElementById('store-name').innerText = store.name;
            
            if(store.logo) { 
                document.getElementById('store-logo').src = store.logo; 
                document.getElementById('store-logo').classList.remove('hidden'); 
                document.getElementById('store-initial').classList.add('hidden'); 
            } else { 
                document.getElementById('store-initial').innerText = store.name.charAt(0).toUpperCase(); 
            }
            
            updateText();
        }

        function renderCategories() {
            const store = ALL_STORES[STATE.storeId];
            if (!store) return;
            
            const cats = ['all', ...new Set(store.products.map(p => p.category))];
            document.getElementById('category-list').innerHTML = cats.map(cat => `
                <button onclick="setCategory('${cat}')" class="${cat===STATE.activeCategory ? 'bg-black text-[#D4AF37] border-black shadow-md' : 'bg-white text-gray-600 border-gray-200'} px-4 py-2 rounded-full text-xs font-bold border whitespace-nowrap capitalize transition-all">
                    ${cat==='all' ? (STATE.lang==='ar'?'ÿßŸÑŸÉŸÑ':(STATE.lang==='fr'?'Tout':'El Kol')) : cat}
                </button>`).join('');
        }

        function renderProducts(animate = false) {
            const store = ALL_STORES[STATE.storeId];
            if (!store) return;
            
            const grid = document.getElementById('product-grid');
            const t = DICTIONARY[STATE.lang];
            const filtered = store.products.filter(p => 
                (STATE.activeCategory === 'all' || p.category === STATE.activeCategory) && 
                p.name.toLowerCase().includes(STATE.searchQuery)
            );

            if (filtered.length === 0) { 
                document.getElementById('empty-state').classList.remove('hidden'); 
                document.getElementById('empty-state').classList.add('flex'); 
                grid.innerHTML = ''; 
                return; 
            }
            
            document.getElementById('empty-state').classList.add('hidden'); 
            document.getElementById('empty-state').classList.remove('flex');

            grid.innerHTML = filtered.map((p, i) => {
                const qty = STATE.cart[p.id] || 0;
                const img = p.image ? 
                    `<img src="${p.image}" class="w-full h-full object-cover" onerror="this.src='https://placehold.co/400'">` : 
                    `<div class="w-full h-full bg-gray-200 flex items-center justify-center font-bold text-2xl">${p.name[0]}</div>`;
                
                const animationClass = animate ? 'fade-in' : '';
                const animationStyle = animate ? `style="animation-delay:${i*50}ms"` : '';

                const btn = qty === 0 
                    ? `<button onclick="updateCart(${p.id}, 1)" class="w-full bg-gray-100 hover:bg-black hover:text-[#D4AF37] text-gray-900 font-bold py-3 rounded-xl text-xs uppercase transition-colors">${t.add}</button>`
                    : `<div class="flex items-center justify-between bg-black text-[#D4AF37] rounded-xl h-10 w-full shadow-md"><button onclick="updateCart(${p.id}, -1)" class="h-full w-10 font-bold text-lg">-</button><span class="font-bold text-white text-sm">${qty}</span><button onclick="updateCart(${p.id}, 1)" class="h-full w-10 font-bold text-lg">+</button></div>`;
                
                return `
                <div class="bg-white rounded-2xl p-2.5 shadow-sm border border-gray-100 flex flex-col h-full ${animationClass}" ${animationStyle}>
                    <div class="relative w-full aspect-square bg-gray-50 rounded-xl overflow-hidden mb-3">
                        ${img}
                        ${qty>0?`<div class="absolute top-2 right-2 bg-[#D4AF37] text-black text-[10px] font-bold w-6 h-6 rounded-full flex items-center justify-center border border-white">${qty}</div>`:''}
                    </div>
                    <div class="flex-grow flex flex-col justify-between">
                        <div class="mb-3">
                            <h3 class="font-bold text-gray-900 text-sm leading-tight mb-1 line-clamp-2">${p.name}</h3>
                            <p class="text-[#D4AF37] font-black text-sm">${p.price.toFixed(3)} <span class="text-[10px] text-gray-400 font-medium">${t.currency}</span></p>
                        </div>
                        ${btn}
                    </div>
                </div>`;
            }).join('');
        }

        function updateCart(id, change) {
            const next = (STATE.cart[id] || 0) + change;
            if (next <= 0) delete STATE.cart[id]; 
            else STATE.cart[id] = next;
            
            if (navigator.vibrate) navigator.vibrate(30);
            
            renderProducts(false); 
            updateBar(); 
            updateModalList();
        }

        function updateBar() {
            const store = ALL_STORES[STATE.storeId];
            if (!store) return;
            
            const total = Object.entries(STATE.cart).reduce((s, [id, q]) => {
                const product = store.products.find(x => x.id == id);
                return s + (product ? product.price * q : 0);
            }, 0);
            
            const count = Object.values(STATE.cart).reduce((a, b) => a + b, 0);
            
            document.getElementById('bar-total').innerText = total.toFixed(3) + ' ' + DICTIONARY[STATE.lang].currency;
            document.getElementById('cart-badge').innerText = count;
            
            const bar = document.getElementById('cart-bar');
            count > 0 ? bar.classList.remove('translate-y-full') : bar.classList.add('translate-y-full');
        }

        function updateModalList() {
            const store = ALL_STORES[STATE.storeId];
            if (!store) return;
            
            document.getElementById('cart-list').innerHTML = Object.entries(STATE.cart).map(([id, qty]) => {
                const p = store.products.find(x => x.id == id);
                if (!p) return '';
                
                return `
                <div class="flex justify-between items-center bg-gray-50 p-3 rounded-xl border border-gray-100 mb-2">
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 bg-white rounded-lg overflow-hidden border border-gray-200">
                            <img src="${p.image||'https://placehold.co/100'}" class="w-full h-full object-cover">
                        </div>
                        <div>
                            <p class="font-bold text-sm text-gray-900 line-clamp-1">${p.name}</p>
                            <p class="text-xs text-gray-500 font-medium">${qty} x ${p.price.toFixed(3)}</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <p class="font-bold text-[#D4AF37] text-sm">${(p.price*qty).toFixed(3)}</p>
                        <button onclick="updateCart(${id}, -${qty})" class="text-red-400 p-2">‚úï</button>
                    </div>
                </div>`;
            }).join('');
        }

        function sendToWhatsApp() {
            const store = ALL_STORES[STATE.storeId];
            if (!store) return;
            
            const t = DICTIONARY[STATE.lang];
            let phone = store.phone.replace(/\D/g, ''); 
            if (!phone.startsWith('216')) phone = '216' + phone;
            
            let msg = `*${store.name}*\n${t.whatsappIntro}\n\n`;
            let total = 0;
            
            Object.entries(STATE.cart).forEach(([id, qty]) => {
                const p = store.products.find(x => x.id == id);
                if (p) {
                    const line = p.price * qty; 
                    total += line;
                    msg += `‚ñ´Ô∏è ${qty}x ${p.name} (${line.toFixed(3)} ${t.currency})\n`;
                }
            });
            
            msg += `\n*${t.total}: ${total.toFixed(3)} ${t.currency}*`;
            window.open(`https://wa.me/${phone}?text=${encodeURIComponent(msg)}`, '_blank');
        }

        function toggleModal(show) { 
            const m = document.getElementById('cart-modal'); 
            if (show) {
                m.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            } else {
                m.classList.add('hidden');
                document.body.style.overflow = ''; 
            }
        }

        // ==================== LANGUAGE FUNCTIONS ====================
        function cycleLanguage() { 
            const l = ['tn', 'fr', 'ar']; 
            STATE.lang = l[(l.indexOf(STATE.lang) + 1) % 3]; 
            document.documentElement.dir = STATE.lang === 'ar' ? 'rtl' : 'ltr'; 
            updateText(); 
            renderCategories(); 
            renderProducts(true); 
            updateBar(); 
        }
        
        function updateText() { 
            const t = DICTIONARY[STATE.lang]; 
            document.querySelectorAll('[data-translate]').forEach(el => el.innerText = t[el.getAttribute('data-translate')]); 
            const i = { tn: 'üáπüá≥', fr: 'üá´üá∑', ar: 'üá∏üá¶' }; 
            document.getElementById('lang-icon').innerText = i[STATE.lang]; 
            document.getElementById('lang-text').innerText = STATE.lang.toUpperCase(); 
            document.getElementById('search-input').placeholder = STATE.lang === 'ar' ? 'ÿ®ÿ≠ÿ´...' : '...'; 
        }
        
        function setCategory(c) { 
            STATE.activeCategory = c; 
            renderCategories(); 
            renderProducts(true); 
        }
        
        function handleSearch() { 
            STATE.searchQuery = document.getElementById('search-input').value.toLowerCase(); 
            renderProducts(false); 
        }

        // ==================== ENHANCED ADMIN FUNCTIONS ====================
        function toggleAdminPanel() {
            const panel = document.getElementById('admin-panel');
            if (panel.classList.contains('hidden')) {
                panel.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                showAdminStats();
                renderClientsList();
            } else {
                panel.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }

        function showAdminStats() {
            const activeClients = Object.keys(ALL_STORES).length - 1; // Exclude demo
            const productCount = Object.values(ALL_STORES).reduce((total, store) => total + (store.products ? store.products.length : 0), 0);
            
            document.getElementById('client-count').textContent = activeClients;
            document.getElementById('product-count').textContent = productCount;
            document.getElementById('active-clients').textContent = `${activeClients} actifs`;
        }

        function copyTemplate(templateId) {
            const textarea = document.getElementById(templateId);
            textarea.select();
            document.execCommand('copy');
            
            // Visual feedback
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '‚úÖ Copi√©!';
            btn.style.backgroundColor = '#10B981';
            
            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.backgroundColor = '';
            }, 2000);
            
            alert('Message copi√©! Collez-le dans WhatsApp.');
        }

        function showImportHelp() {
            alert(`üìù Formats accept√©s pour les produits:

1. Avec tiret: "Robe rouge - 89 DT"
2. Avec pipe: "Robe rouge | 89.000"
3. Avec cat√©gorie: "Robe rouge | 89.000 | V√™tements"
4. Simple: "Robe rouge 89.000 V√™tements"

Le syst√®me formatera automatiquement!`);
        }

        function formatProducts() {
            let input = document.getElementById('client-products').value.trim();
            if (!input) return;
            
            let formatted = '';
            const lines = input.split('\n');
            let productId = 1;
            
            lines.forEach((line, index) => {
                line = line.trim();
                if (!line) return;
                
                // Remove numbers like "1. " or "1) "
                line = line.replace(/^\d+[\.\)]\s*/, '');
                
                // Try different formats
                let name = '', price = '', category = 'G√©n√©ral';
                
                // Format: "Produit - Prix DT"
                if (line.includes(' - ') && line.toUpperCase().includes('DT')) {
                    const parts = line.split(' - ');
                    name = parts[0].trim();
                    price = parts[1].replace(/[^\d.]/g, '');
                }
                // Format: "Produit | Prix | Cat√©gorie"
                else if (line.includes('|')) {
                    const parts = line.split('|').map(p => p.trim());
                    name = parts[0];
                    if (parts.length > 1) price = parts[1].replace(/[^\d.]/g, '');
                    if (parts.length > 2) category = parts[2];
                }
                // Format: "Produit Prix Cat√©gorie"
                else {
                    const words = line.split(' ');
                    // Find price (contains numbers)
                    const priceIndex = words.findIndex(w => /\d/.test(w));
                    if (priceIndex !== -1) {
                        name = words.slice(0, priceIndex).join(' ');
                        price = words[priceIndex].replace(/[^\d.]/g, '');
                        category = words.slice(priceIndex + 1).join(' ') || 'G√©n√©ral';
                    } else {
                        name = line;
                    }
                }
                
                // Ensure price has 3 decimals
                if (price && !price.includes('.')) {
                    price = price + '.000';
                } else if (price && price.split('.')[1]?.length < 3) {
                    price = price.padEnd(price.split('.')[0].length + 4, '0');
                }
                
                price = price || '0.000';
                
                formatted += `${name} | ${price} | ${category}\n`;
            });
            
            document.getElementById('client-products').value = formatted.trim();
            
            // Visual feedback
            const btn = event.target;
            btn.textContent = '‚úÖ Format√©!';
            btn.style.backgroundColor = '#10B981';
            
            setTimeout(() => {
                btn.textContent = 'üîß Formater automatiquement';
                btn.style.backgroundColor = '';
            }, 1500);
        }

        function testProducts() {
            const input = document.getElementById('client-products').value.trim();
            if (!input) {
                alert('Aucun produit √† pr√©visualiser');
                return;
            }
            
            const lines = input.split('\n');
            let previewHTML = '';
            
            lines.forEach((line, index) => {
                line = line.trim();
                if (!line) return;
                
                const parts = line.split('|').map(p => p.trim());
                const name = parts[0] || 'Produit sans nom';
                const price = parts[1] || '0.000';
                const category = parts[2] || 'G√©n√©ral';
                
                previewHTML += `
                <div class="bg-gray-50 p-3 rounded-lg border">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="font-bold text-sm">${name}</p>
                            <p class="text-xs text-gray-600">Cat√©gorie: ${category}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-[#D4AF37] font-bold">${price} DT</p>
                            <p class="text-[10px] text-gray-500">Produit ${index + 1}</p>
                        </div>
                    </div>
                </div>`;
            });
            
            document.getElementById('preview-content').innerHTML = previewHTML || '<p class="text-gray-500">Aucun produit valide</p>';
            document.getElementById('preview-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closePreview() {
            document.getElementById('preview-modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        function addNewClient() {
            const id = document.getElementById('client-id').value.trim();
            const name = document.getElementById('client-name').value.trim();
            const phone = document.getElementById('client-phone').value.trim();
            const logo = document.getElementById('client-logo').value.trim();
            const productsText = document.getElementById('client-products').value.trim();
            
            if (!id || !name || !phone) {
                alert('‚ùå ID, nom et WhatsApp sont obligatoires!');
                return;
            }
            
            if (ALL_STORES[id] && id !== 'demo') {
                if (!confirm(`Store "${id}" existe d√©j√†. Remplacer?`)) {
                    return;
                }
            }
            
            // Parse products
            const products = [];
            let productId = 1;
            
            if (productsText) {
                const lines = productsText.split('\n');
                lines.forEach(line => {
                    line = line.trim();
                    if (line) {
                        const parts = line.split('|').map(p => p.trim());
                        if (parts.length >= 2) {
                            products.push({
                                id: productId++,
                                name: parts[0],
                                price: parseFloat(parts[1]) || 0,
                                category: parts[2] || 'G√©n√©ral',
                                image: ''
                            });
                        }
                    }
                });
            }
            
            // Add store
            ALL_STORES[id] = {
                name: name,
                phone: phone.replace(/\D/g, ''),
                logo: logo,
                products: products
            };
            
            // Save
            localStorage.setItem('vitrina_stores', JSON.stringify(ALL_STORES));
            
            // Clear form
            document.getElementById('client-id').value = '';
            document.getElementById('client-name').value = '';
            document.getElementById('client-phone').value = '';
            document.getElementById('client-logo').value = '';
            document.getElementById('client-products').value = '';
            
            // Update UI
            showAdminStats();
            renderClientsList();
            
            // Set current client for welcome message
            STATE.currentClientId = id;
            
            // Show success with store link
            const storeUrl = `${window.location.origin}${window.location.pathname}?store=${id}`;
            alert(`‚úÖ Store cr√©√©!\n\nüîó Lien: ${storeUrl}\n\nCliquez sur "G√©n√©rer message" pour le message de bienvenue.`);
        }

        function generateWelcomeMessage() {
            const id = STATE.currentClientId || document.getElementById('client-id').value.trim();
            
            if (!id || !ALL_STORES[id]) {
                alert('Cr√©ez d\'abord un store ou s√©lectionnez-en un');
                return;
            }
            
            const store = ALL_STORES[id];
            const storeUrl = `${window.location.origin}${window.location.pathname}?store=${id}`;
            const phone = store.phone.replace(/\D/g, '');
            
            // Welcome message in French and Tunisian Arabic
            const message = `üéâ F√©licitations! Votre boutique est pr√™te:

üîó *Lien de votre boutique:*
${storeUrl}

üì¶ *Comment √ßa marche:*
1. Partagez le lien avec vos clients
2. Ils choisissent les produits
3. Ils passent commande via WhatsApp
4. Vous recevez la commande compl√®te

üí∞ *Abonnement:* 30 DT/mois
üí≥ *Paiement:* D17 / Flouci / Sobflous

üéØ *Prochaines √©tapes:*
1. Testez votre boutique: ${storeUrl}
2. Envoyez-moi votre retour
3. Paiement premier mois: 30 DT

‚úÖ *Votre boutique:*
Nom: ${store.name}
Produits: ${store.products.length}
WhatsApp: ${store.phone}

ŸÖÿ®ÿ±ŸàŸÉ! ÿ≠ÿßŸÜŸàÿ™ŸÉ ÿ¨ÿßŸáÿ≤ÿ©
ÿ¨ÿ±ÿ® ÿ≠ÿßŸÜŸàÿ™ŸÉ: ${storeUrl}`;
            
            // Create WhatsApp link
            const whatsappUrl = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
            
            // Show options
            const choice = confirm(`Message de bienvenue g√©n√©r√©!\n\n1. "OK" pour copier le message\n2. "Annuler" pour ouvrir WhatsApp directement`);
            
            if (choice) {
                // Copy to clipboard
                const textarea = document.createElement('textarea');
                textarea.value = message;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('‚úÖ Message copi√©! Collez-le dans WhatsApp.');
            } else {
                // Open WhatsApp directly
                window.open(whatsappUrl, '_blank');
            }
        }

        function renderClientsList() {
            const container = document.getElementById('clients-list');
            container.innerHTML = '';
            
            Object.entries(ALL_STORES).forEach(([id, store]) => {
                if (id === 'demo') return;
                
                const productCount = store.products ? store.products.length : 0;
                const storeUrl = `${window.location.origin}${window.location.pathname}?store=${id}`;
                
                container.innerHTML += `
                <div class="bg-gray-50 border border-gray-200 p-4 rounded-xl">
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <h4 class="font-bold text-gray-900">${store.name}</h4>
                            <p class="text-xs text-gray-600">ID: <code class="bg-gray-200 px-1">${id}</code></p>
                            <p class="text-xs text-gray-600">${productCount} produits ‚Ä¢ ${store.phone}</p>
                        </div>
                        <div class="flex flex-col gap-1">
                            <button onclick="selectClient('${id}')" class="text-xs bg-blue-500 text-white px-3 py-1 rounded-lg">üí¨ Message</button>
                            <button onclick="viewStore('${id}')" class="text-xs bg-green-500 text-white px-3 py-1 rounded-lg">üëÅÔ∏è Voir</button>
                            <button onclick="deleteStore('${id}')" class="text-xs bg-red-500 text-white px-3 py-1 rounded-lg">üóëÔ∏è</button>
                        </div>
                    </div>
                    <div class="flex gap-2 mt-2">
                        <input type="text" value="${storeUrl}" readonly class="flex-1 text-xs p-2 bg-white border rounded">
                        <button onclick="copyText('${storeUrl}')" class="text-xs bg-gray-200 text-gray-800 px-2 rounded">üìã</button>
                    </div>
                </div>`;
            });
            
            if (Object.keys(ALL_STORES).length <= 1) {
                container.innerHTML = '<p class="text-gray-500 text-center py-4">Aucun client encore</p>';
            }
        }

        function selectClient(id) {
            STATE.currentClientId = id;
            const store = ALL_STORES[id];
            
            document.getElementById('client-id').value = id;
            document.getElementById('client-name').value = store.name;
            document.getElementById('client-phone').value = store.phone;
            document.getElementById('client-logo').value = store.logo || '';
            
            // Format products for textarea
            const productsText = store.products.map(p => 
                `${p.name} | ${p.price.toFixed(3)} | ${p.category}`
            ).join('\n');
            
            document.getElementById('client-products').value = productsText;
            
            // Scroll to form
            document.getElementById('client-id').scrollIntoView();
            alert(`Client ${store.name} s√©lectionn√©! Cliquez "G√©n√©rer message" pour envoyer le message de bienvenue.`);
        }

        function viewStore(id) {
            window.open(`?store=${id}`, '_blank');
        }

        function copyText(text) {
            navigator.clipboard.writeText(text).then(() => {
                const btn = event.target;
                btn.textContent = '‚úÖ';
                setTimeout(() => btn.textContent = 'üìã', 2000);
            });
        }

        function deleteStore(id) {
            if (id === 'demo') {
                alert('Le store demo ne peut pas √™tre supprim√©');
                return;
            }
            
            if (confirm(`Supprimer le store "${ALL_STORES[id].name}"? Cette action est irr√©versible.`)) {
                delete ALL_STORES[id];
                localStorage.setItem('vitrina_stores', JSON.stringify(ALL_STORES));
                showAdminStats();
                renderClientsList();
                alert('Store supprim√©');
            }
        }

        function exportStores() {
            const dataStr = JSON.stringify(ALL_STORES, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `vitrina_stores_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            alert('‚úÖ Stores export√©s! Sauvegarde ce fichier sur ton t√©l√©phone.');
        }

        function importStores() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        const importedStores = JSON.parse(e.target.result);
                        ALL_STORES = { ...ALL_STORES, ...importedStores };
                        localStorage.setItem('vitrina_stores', JSON.stringify(ALL_STORES));
                        showAdminStats();
                        renderClientsList();
                        alert('‚úÖ Stores import√©s avec succ√®s!');
                    } catch (err) {
                        alert('‚ùå Erreur: Fichier JSON invalide');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }

        function clearAllData() {
            if (confirm('R√©initialiser toutes les donn√©es clients? (demo sera conserv√©)')) {
                ALL_STORES = DEMO_STORE;
                localStorage.setItem('vitrina_stores', JSON.stringify(ALL_STORES));
                showAdminStats();
                renderClientsList();
                alert('‚úÖ Donn√©es r√©initialis√©es!');
            }
        }

        // ==================== START APP ====================
        document.addEventListener('DOMContentLoaded', init);
    </script>

</body>
</html>